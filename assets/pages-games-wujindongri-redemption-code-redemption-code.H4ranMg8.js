import{_ as a,r as e,l as t,c as s,a as l,w as d,F as c,J as i,af as r,K as u,s as o,i as n,b as _,o as f,g as m,h as p,e as b,y,t as v,a5 as g,f as x,n as h,p as w,u as k}from"./index-s_PpT9AL.js";import{a as T,b as j,d as $,c as q}from"./config.Cklr0nrL.js";import{M as K}from"./my-share-button.BrTurric.js";import"./uni-popup.ik2pFpuT.js";const M=a({__name:"redemption-code",setup(a){uni.$sharePageTitle=`兑换码-${T}`;const M=`${j}-redemption-code-use`,N=e({updateTime:"",rewardKeyMap:[],data:[]}),J=e(t(M)||[]);i({title:"加载中"}),r({url:`https://runjs.work/transformer/project?id=${$}`,sslVerify:!1,success:a=>{var e,t;const s=null==(t=null==(e=a.data.data)?void 0:e.js)?void 0:t.source;if(s){const a=JSON.parse(s.replace(/\n/g," ").replace(/&quot;/g,'"')),{updateTime:e,rewardKeyMap:t,data:l}=a;N.value.updateTime=e,N.value.rewardKeyMap=t,N.value.data=l.reverse()}else o({title:"资源加载异常",icon:"none"})},fail:()=>{o({title:"资源加载失败",icon:"error"})},complete:()=>{u()}});const C=a=>{const{code:e}=a.currentTarget.dataset;J.value.find((a=>a===e))||J.value.push(e),w(M,J.value),k({data:e,success:()=>{}})};return(a,e)=>{const t=_("my-page-header"),i=n,r=y,u=_("my-divider"),o=_("my-ad-custom"),w=_("my-bottom-safety-space");return f(),s(c,null,[l(t),l(i,{class:"pt_4"},{default:d((()=>[l(i,{class:"mx_4 mb_2 shadow radius bg-color"},{default:d((()=>[l(i,{class:"d_flex px_4 py_4 items_center"},{default:d((()=>[l(i,{class:"font_bold grow"},{default:d((()=>[b("兑换码")])),_:1}),N.value.updateTime?(f(),m(i,{key:0},{default:d((()=>[l(r,{class:"mr_2 text-info"},{default:d((()=>[b("更新时间:")])),_:1}),l(r,{class:"text-error font_bold"},{default:d((()=>[b(v(N.value.updateTime),1)])),_:1})])),_:1})):p("",!0)])),_:1})])),_:1}),l(u,null,{default:d((()=>[N.value.data.length?(f(),m(r,{key:0},{default:d((()=>[b("总计"),l(r,{class:"text-primary"},{default:d((()=>[b(v(N.value.data.length),1)])),_:1}),b("个，新增"),l(r,{class:"text-primary"},{default:d((()=>[b(v(N.value.data.filter((a=>a.isNew)).length),1)])),_:1}),b("个，")])),_:1})):p("",!0),b("点击"),l(r,{class:"text-error"},{default:d((()=>[b("复制")])),_:1}),g(q)?(f(),m(r,{key:1},{default:d((()=>[b("并启动"+v(g(T)),1)])),_:1})):p("",!0),b("。 ")])),_:1}),l(i,{class:"mx_4 mb_4 shadow radius bg-color"},{default:d((()=>[(f(!0),s(c,null,x(N.value.data,((e,t)=>(f(),s(c,{key:t},[l(i,{class:h(["d_flex items_center text_base p_4 p_relative",0===t?"radius_t border_b":t===N.value.data.length?"radius_b":"border_b"]),"hover-class":"bg-hover","data-code":e.code,onClick:C},{default:d((()=>[l(i,{class:"p_relative"},{default:d((()=>[b(v(e.code)+" ",1),J.value.includes(e.code)?(f(),m(i,{key:0,class:"yang-badge basic count circle warning"},{default:d((()=>[b("已使用")])),_:1})):p("",!0)])),_:2},1024),l(i,{class:"grow"}),l(i,{class:"text-info text_right"},{default:d((()=>[b(v(e.reward.map(((a,e)=>((a,e)=>e?`${e}${N.value.rewardKeyMap[a]||""}`:"")(e,a))).filter((a=>a)).join("，"))+" ",1),e.invalidityTime?(f(),m(i,{key:0,class:"text-info text_xs"},{default:d((()=>[b("失效时间："+v(e.invalidityTime),1)])),_:2},1024)):p("",!0)])),_:2},1024),e.invalidityTime&&a.dayjs(`${e.invalidityTime} 23:59:59`)<a.dayjs()?(f(),m(i,{key:0,class:"yang-badge ribbon info"},{default:d((()=>[l(i,{class:"content basic"},{default:d((()=>[b("已失效")])),_:1})])),_:1})):p("",!0),"永久"===e.invalidityTime?(f(),m(i,{key:1,class:"yang-badge ribbon"},{default:d((()=>[l(i,{class:"content basic"},{default:d((()=>[b("永久")])),_:1})])),_:1})):p("",!0),e.isNew?(f(),m(i,{key:2,class:"yang-badge ribbon"},{default:d((()=>[l(i,{class:"content basic"},{default:d((()=>[b("NEW")])),_:1})])),_:1})):p("",!0)])),_:2},1032,["class","data-code"]),!((t-2)%15)&&t<N.value.data.length-15+2?(f(),m(i,{key:0},{default:d((()=>[l(o,{mp_weixin:"adunit-a4678d8d13df3114",mp_qq:"c74f0b30cbf1b82004c9c785b7afc1c0",custom_class:"p_0 m_0"})])),_:1})):p("",!0)],64)))),128))])),_:1}),l(o,{mp_weixin:"adunit-8c89cc4610403c81",mp_qq:"54ea1b2e68ecb1caa66494c8dc68d3b7"}),l(w,{version:""})])),_:1}),l(K)],64)}}},[["__scopeId","data-v-2053e06f"]]);export{M as default};
