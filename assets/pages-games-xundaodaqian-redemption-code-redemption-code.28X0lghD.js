import{r as a,l as e,c as t,a as s,w as l,F as d,E as c,ak as i,G as r,s as u,i as o,b as n,o as _,g as f,h as m,e as p,y as b,t as y,a6 as v,f as g,n as x,q as h,u as w}from"./index-Cd7UBVK4.js";import{a as k,b as T,d as j,c as $}from"./config.DbNoEwO4.js";import{M as q}from"./my-share-button.S-20VzvH.js";import"./uni-popup.Cs9snEpv.js";const M={__name:"redemption-code",setup(M){uni.$sharePageTitle=`兑换码-${k}`;const K=`${T}-redemption-code-use`,N=a({updateTime:"",rewardKeyMap:[],data:[]}),E=a(e(K)||[]);c({title:"加载中"}),i({url:`https://runjs.work/transformer/project?id=${j}`,sslVerify:!1,success:a=>{var e,t;const s=null==(t=null==(e=a.data.data)?void 0:e.js)?void 0:t.source;if(s){const a=JSON.parse(s.replace(/\n/g," ").replace(/&quot;/g,'"')),{updateTime:e,rewardKeyMap:t,data:l}=a;N.value.updateTime=e,N.value.rewardKeyMap=t,N.value.data=l.reverse()}else u({title:"资源加载异常",icon:"none"})},fail:()=>{u({title:"资源加载失败",icon:"error"})},complete:()=>{r()}});const C=a=>{const{code:e}=a.currentTarget.dataset;E.value.find((a=>a===e))||E.value.push(e),h(K,E.value),w({data:e,success:()=>{}})};return(a,e)=>{const c=n("my-page-header"),i=o,r=b,u=n("my-divider"),h=n("my-ad-custom"),w=n("my-bottom-safety-space");return _(),t(d,null,[s(c),s(i,{class:"pt_4"},{default:l((()=>[s(i,{class:"mx_4 mb_2 shadow radius bg-color"},{default:l((()=>[s(i,{class:"d_flex px_4 py_4 items_center"},{default:l((()=>[s(i,{class:"font_bold grow"},{default:l((()=>[p("兑换码")])),_:1}),N.value.updateTime?(_(),f(i,{key:0},{default:l((()=>[s(r,{class:"mr_2 text-info"},{default:l((()=>[p("更新时间:")])),_:1}),s(r,{class:"text-error font_bold"},{default:l((()=>[p(y(N.value.updateTime),1)])),_:1})])),_:1})):m("",!0)])),_:1})])),_:1}),s(u,null,{default:l((()=>[N.value.data.length?(_(),f(r,{key:0},{default:l((()=>[p("总计"),s(r,{class:"text-primary"},{default:l((()=>[p(y(N.value.data.length),1)])),_:1}),p("个，新增"),s(r,{class:"text-primary"},{default:l((()=>[p(y(N.value.data.filter((a=>a.isNew)).length),1)])),_:1}),p("个，")])),_:1})):m("",!0),p("点击"),s(r,{class:"text-error"},{default:l((()=>[p("复制")])),_:1}),v($)?(_(),f(r,{key:1},{default:l((()=>[p("并启动"+y(v(k)),1)])),_:1})):m("",!0),p("。 ")])),_:1}),s(i,{class:"mx_4 mb_4 shadow radius bg-color"},{default:l((()=>[(_(!0),t(d,null,g(N.value.data,((e,c)=>(_(),t(d,{key:c},[s(i,{class:x(["d_flex items_center text_base p_4 p_relative",0===c?"radius_t border_b":c===N.value.data.length?"radius_b":"border_b"]),"hover-class":"bg-hover","data-code":e.code,onClick:C},{default:l((()=>[s(i,{class:"p_relative"},{default:l((()=>[p(y(e.code)+" ",1),E.value.includes(e.code)?(_(),f(i,{key:0,class:"yang-badge basic count circle warning"},{default:l((()=>[p("已使用")])),_:1})):m("",!0)])),_:2},1024),s(i,{class:"grow"}),s(i,{class:"text-info text_right"},{default:l((()=>[p(y(e.reward.map(((a,e)=>((a,e)=>e?`${e}${N.value.rewardKeyMap[a]||""}`:"")(e,a))).filter((a=>a)).join("，"))+" ",1),e.invalidityTime?(_(),f(i,{key:0,class:"text-info text_xs"},{default:l((()=>[p("失效时间："+y(e.invalidityTime),1)])),_:2},1024)):m("",!0)])),_:2},1024),e.invalidityTime&&a.dayjs(`${e.invalidityTime} 23:59:59`)<a.dayjs()?(_(),f(i,{key:0,class:"yang-badge ribbon info"},{default:l((()=>[s(i,{class:"content basic"},{default:l((()=>[p("已失效")])),_:1})])),_:1})):m("",!0),"永久"===e.invalidityTime?(_(),f(i,{key:1,class:"yang-badge ribbon"},{default:l((()=>[s(i,{class:"content basic"},{default:l((()=>[p("永久")])),_:1})])),_:1})):m("",!0),e.isNew?(_(),f(i,{key:2,class:"yang-badge ribbon"},{default:l((()=>[s(i,{class:"content basic"},{default:l((()=>[p("NEW")])),_:1})])),_:1})):m("",!0)])),_:2},1032,["class","data-code"]),!((c-2)%15)&&c<N.value.data.length-15+2?(_(),f(i,{key:0},{default:l((()=>[s(h,{mp_weixin:"adunit-a4678d8d13df3114",mp_qq:"c74f0b30cbf1b82004c9c785b7afc1c0",custom_class:"p_0 m_0"})])),_:1})):m("",!0)],64)))),128))])),_:1}),s(h,{mp_weixin:"adunit-8c89cc4610403c81",mp_qq:"54ea1b2e68ecb1caa66494c8dc68d3b7"}),s(w,{version:""})])),_:1}),s(q)],64)}}};export{M as default};
