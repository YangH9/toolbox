import{_ as e,r as a,ad as l,p as t,c as s,a as i,w as n,F as c,i as r,x as u,b as o,C as d,D as _,o as v,e as p,t as b,f,g as m,n as x,h,B as g,q as y,ae as k,af as I,ag as L}from"./index-Cjrv_Xtf.js";import{_ as C}from"./uni-popup.Cy4XcbS3.js";import{a as q,b as M}from"./config.Dny4K3GL.js";import{f as w}from"./data-all.154RLuAQ.js";const $=e({__name:"count-battlevalues",setup(e){uni.$sharePageTitle=`战力计算器-${q}`;const $=`${M}-count-battlevalues`,S=w.partData.map((e=>e.combat)),O={};w.driverOption.position.forEach((e=>O[e.value]=e.combat));const P={};w.driverOption.core.forEach((e=>P[e.value]=e.combat));const E=a([]),j=a(w.originalCrystalData.combatList),A=a({label:"皮肤",attack:50,health:1e3}),J=a([]),N=a([]),D={e:[{p:1,e:100,g:10,o:[3,3,3,3],s:1},{p:2,e:100,g:10,o:[3,3,3,3],s:0},{p:3,e:100,g:10,o:[3,3,3,3],s:1},{p:4,e:100,g:10,o:[3,3,3,3],s:1}],p:[{p:5,c:25,m:1},{p:4,c:25,m:0},{p:7,c:25,m:0},{p:9,c:25,m:0}],c:[{c:5,m:20},{c:7,m:20},{c:9,m:20}]},T=a({}),X=a(null),H=a({visible:!1,editIndex:0,part:0,partLabel:"",equipment:[0,0],original:[0,0,0,0],hasSkin:!1}),B=a(null),F=a({visible:!1,editIndex:0,isMain:!1,pilot:[0],combatIndex:[0]}),z=a(null),G=a({visible:!1,editIndex:0,core:[0],combatIndex:[0]}),K=a({attack:0,health:0,combat:0}),Q=a([]),R=a([]),U=a([]);(()=>{const{partData:e,planeOption:a,aresOption:l,driverOption:t,planeList:s,aresList:i,driverList:n}=JSON.parse(JSON.stringify(w));E.value=e.map(((e,t)=>({label:e.label,part:e.value,children:[s.map(((l,s)=>l.part[t].quality.map(((t,s)=>{let i=a.quality[s];return{label:t,partLabel:e.label,key:`plane-${e.value}-${l.suit}-${i.value}`,part:e.value,quality:i.value,suit:l.suit,children:i.gradation.map(((e,a)=>{const t=e.value?e.isMax?"MAX":`+${e.value}`:"",n=l.combat[s][a].at(-1);return{label:`${i.label}${t}`,value:e.value,isMax:e.isMax,level:e.maxLevel,attack:n.attack,health:n.health}}))}})))),i.map(((a,s)=>a.part[t].quality.map(((t,s)=>{let i=l.quality[s];return{label:t,partLabel:e.label,key:`ares-${e.value}-${a.suit}-${i.value}`,part:e.value,quality:i.value,suit:a.suit,children:i.gradation.map(((e,l)=>{const t=e.value?e.isMax?"MAX":`+${e.value}`:"",n=a.combat[s][l].at(-1);return{label:`${i.label}${t}`,value:e.value,isMax:e.isMax,level:e.maxLevel,attack:n.basicAttack+n.syncAttack,health:n.basicHealth+n.syncHealth}}))}}))))].flat(2)}))),J.value=n.map((e=>{const a=e.potential.length;return{label:e.title,star:e.star,key:"driver",children:t.quality.map(((a,l)=>{const t=e.combat[l].at(-1);return{label:a.label,quality:a.value,level:t.level,combat:t.part}})).concat(e.potential.map(((e,l)=>({label:"潜能"+(l+1===a?"MAX":`${l+1}/${a}`),quality:4,level:90,combat:e.part}))))}})),N.value=n.map((e=>{const a=e.potential.length;return{label:e.stunt,pilot:e.title,star:e.star,key:"core",children:e.potential.map(((e,l)=>({coreLevel:e.coreLevel,label:"潜能"+(l+1===a?"MAX":`${l+1}/${a}`),combat:e.part})))}}))})();l((()=>{T.value=t($)||JSON.parse(JSON.stringify(D)),(()=>{const{e:e,p:a,c:l}=T.value;e.forEach(((e,a)=>{H.value={visible:!1,editIndex:a,part:e.p,partLabel:"",equipment:[e.e,e.g],original:e.o,hasSkin:!!e.s},Y()})),a.forEach(((e,a)=>{F.value={visible:!1,editIndex:a,isMain:!!e.m,pilot:[e.p],combatIndex:[e.c]},ae()})),l.forEach(((e,a)=>{G.value={visible:!1,editIndex:a,core:[e.c],combatIndex:[e.m]},se()}))})()}));const V=()=>{const e=[0,0,0,0];Q.value.forEach(((a,l)=>{e[l]=a.combat,a.hasSkin&&(e[l]+=2===a.part?A.value.health:A.value.attack),R.value.forEach((a=>{e[l]+=a.partCombat[l]})),U.value.forEach((a=>{e[l]+=a.partCombat[l]}));const t=a.originalCrystal.filter((e=>e.isPercentage)).reduce(((e,a)=>e+a.value),0),s=a.originalCrystal.filter((e=>!e.isPercentage)).reduce(((e,a)=>e+a.value),0);e[l]+=e[l]*t,e[l]+=s})),K.value.combat=e.reduce(((e,a,l)=>e+a*S[l]),0)};V();const W=e=>{const a=e.currentTarget.dataset.index,l=JSON.parse(JSON.stringify(Q.value[a]));H.value={visible:!0,editIndex:a,part:l.part,partLabel:l.partLabel,equipment:[l.equiIndex,l.gradaIndex],original:l.originalIndex,hasSkin:l.hasSkin},X.value.open()},Y=()=>{const e=H.value,a=E.value.find((a=>a.part===e.part)),l=a.children[e.equipment[0]]??a.children.at(-1),t=l.children[e.equipment[1]]??l.children.at(-1),s=j.value,i={label:l.label,key:l.key,part:l.part,partLabel:l.partLabel,gradationLabel:t.label,level:t.level,combat:2===e.part?t.health:t.attack,equiIndex:e.equipment[0],gradaIndex:e.equipment[1],originalIndex:e.original,originalCrystal:s.map(((a,l)=>{var t,s,i,n;return 2===e.part?{label:a.healthLabel[null==(t=e.original)?void 0:t[l]]??a.healthLabel.at(-1),value:a.health[null==(s=e.original)?void 0:s[l]]??a.health.at(-1),isPercentage:!!a.isPercentage}:{label:a.attackLabel[null==(i=e.original)?void 0:i[l]]??a.attackLabel.at(-1),value:a.attack[null==(n=e.original)?void 0:n[l]]??a.attack.at(-1),isPercentage:!!a.isPercentage}})),hasSkin:!!e.hasSkin};if(Q.value[e.editIndex]=i,e.visible){const a={p:l.part,e:e.equipment[0],g:e.equipment[1],o:e.original,s:+e.hasSkin};T.value.e[e.editIndex]=a,Z(),ne()}V()},Z=()=>{H.value.visible=!1,X.value.close()},ee=e=>{const a=e.currentTarget.dataset.index,l=R.value[a];F.value={visible:!0,editIndex:a,isMain:l.isMain,pilot:[l.index],combatIndex:[l.combatIndex]},B.value.open()},ae=()=>{const e=F.value,a=J.value[e.pilot[0]]??J.value.at(-1),l=a.children[e.combatIndex[0]]??a.children.at(-1),t={key:a.key,label:a.label,gradationLabel:l.label,level:l.level,index:e.pilot[0],combatIndex:e.combatIndex[0],isMain:e.isMain,quality:l.quality,combat:l.combat.reduce(((a,l,t)=>a+l*O[e.isMain]*S[t]),0),partCombat:l.combat.map((a=>a*O[e.isMain]))};if(R.value[e.editIndex]=t,e.visible){const a={p:e.pilot[0],c:e.combatIndex[0],m:+e.isMain};T.value.p[e.editIndex]=a,le(),ne()}V()},le=()=>{F.value.visible=!1,B.value.close()},te=e=>{const a=e.currentTarget.dataset.index,l=U.value[a];G.value={visible:!0,editIndex:a,core:[l.index],combatIndex:[l.combatIndex]},z.value.open()},se=()=>{const e=G.value,a=N.value[e.core[0]]??N.value.at(-1),l=a.children[e.combatIndex[0]]??a.children.at(-1),t={key:a.key,label:a.label,pilot:a.pilot,gradationLabel:l.label,level:l.coreLevel,index:e.core[0],combatIndex:e.combatIndex[0],type:e.editIndex+1,combat:l.combat.reduce(((e,a,t)=>e+a*P[l.coreLevel]*S[t]),0),partCombat:l.combat.map((e=>e*P[l.coreLevel]))};if(U.value[e.editIndex]=t,e.visible){const a={c:e.core[0],m:e.combatIndex[0]};T.value.c[e.editIndex]=a,ie(),ne()}V()},ie=()=>{G.value.visible=!1,z.value.close()},ne=()=>{u($,T.value)};return(e,a)=>{const l=o("my-page-header"),t=r,u=g,q=y,M=I,w=k,$=L,S=d(_("uni-popup"),C),O=o("my-divider"),P=o("my-ad-custom"),A=o("my-bottom-safety-space");return v(),s(c,null,[i(l),i(t,{class:"pt_4"},{default:n((()=>[i(t,{class:"mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[i(t,{class:"d_flex px_4 items_center"},{default:n((()=>[i(t,{class:"py_4 font_bold"},{default:n((()=>[p("总战力")])),_:1}),i(t,{class:"grow"}),i(t,{class:"py_4"},{default:n((()=>[p(b(Math.round(K.value.combat)),1)])),_:1})])),_:1})])),_:1}),i(t,{class:"mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[(v(!0),s(c,null,f(Q.value,((e,a)=>(v(),m(t,{key:a,class:x(["d_flex items_center text_base px_4 border_b p_relative",0===a?"radius_t":a===Q.value.length?"radius_b":""]),"hover-class":"bg-hover","data-index":a,onClick:W},{default:n((()=>[i(t,{class:"my_4 p_relative"},{default:n((()=>[i(t,null,{default:n((()=>[p(b(e.label||e.partLabel),1),i(u,{class:"text_xs text-info"},{default:n((()=>[p(" - "+b(e.gradationLabel)+" - Lv."+b(e.level),1)])),_:2},1024)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[p(b(e.originalCrystal.map((e=>e.label)).join("、")),1)])),_:2},1024),e.hasSkin?(v(),m(t,{key:0,class:"yang-badge basic count circle warning"},{default:n((()=>[p("有皮肤")])),_:1})):h("",!0)])),_:2},1024),i(t,{class:"grow"}),i(t,{class:"text-info text_right"},{default:n((()=>[p(b(e.combat),1)])),_:2},1024),i(t,{class:"yang-badge ribbon"},{default:n((()=>[i(t,{class:"content basic"},{default:n((()=>[p(b(e.partLabel),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","data-index"])))),128))])),_:1}),i(t,{class:"mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[(v(!0),s(c,null,f(R.value,((e,a)=>(v(),m(t,{key:a,class:x(["d_flex items_center text_base px_4 border_b p_relative",0===a?"radius_t":a===R.value.length?"radius_b":""]),"hover-class":"bg-hover","data-index":a,onClick:ee},{default:n((()=>[i(t,{class:"my_4 p_relative"},{default:n((()=>[i(t,null,{default:n((()=>[p(b(e.label||(e.isMain?"主驾驶":"副驾驶")),1),i(u,{class:"text_xs text-info"},{default:n((()=>[p(" - "+b(e.gradationLabel)+" - Lv."+b(e.level),1)])),_:2},1024)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[p(b(e.partCombat.map((e=>Math.round(e))).join("、")),1)])),_:2},1024)])),_:2},1024),i(t,{class:"grow"}),i(t,{class:"text-info text_right"},{default:n((()=>[p(b(Math.round(e.combat)),1)])),_:2},1024),i(t,{class:"yang-badge ribbon"},{default:n((()=>[i(t,{class:"content basic"},{default:n((()=>[p(b(e.isMain?"主驾驶":"副驾驶"),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","data-index"])))),128))])),_:1}),i(t,{class:"mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[(v(!0),s(c,null,f(U.value,((e,a)=>(v(),m(t,{key:a,class:x(["d_flex items_center text_base px_4 border_b p_relative",0===a?"radius_t":a===U.value.length?"radius_b":""]),"hover-class":"bg-hover","data-index":a,onClick:te},{default:n((()=>[i(t,{class:"my_4 p_relative"},{default:n((()=>[i(t,null,{default:n((()=>[p(b(e.label),1),i(u,{class:"text_xs text-info"},{default:n((()=>[p(" - Lv."+b(e.level)+" - "+b(e.pilot)+" - "+b(e.gradationLabel),1)])),_:2},1024)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[p(b(e.partCombat.map((e=>Math.round(e))).join("、")),1)])),_:2},1024)])),_:2},1024),i(t,{class:"grow"}),i(t,{class:"text-info text_right"},{default:n((()=>[p(b(Math.round(e.combat)),1)])),_:2},1024),i(t,{class:"yang-badge ribbon"},{default:n((()=>[i(t,{class:"content basic"},{default:n((()=>[p("核心"+b(e.type),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","data-index"])))),128))])),_:1}),i(S,{ref_key:"editEquipmentPopup",ref:X,type:"bottom","safe-area":!1,"mask-click":!1},{default:n((()=>[H.value.visible?(v(),m(t,{key:0,class:"bg-color radius_t"},{default:n((()=>[i(t,{class:"d_flex px_4 py_3 items_center"},{default:n((()=>[i(t,{class:"font_bold"},{default:n((()=>[p("修改装备("+b(H.value.partLabel)+")",1)])),_:1}),i(t,{class:"grow"}),i(q,{class:"yang-button outline extra-small my-icon-close","hover-class":"hover",onClick:Z})])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[p("装备")])),_:1}),i(t,{class:"grow"}),i(w,{value:H.value.equipment,class:"popup-picker","immediate-change":"",onChange:a[0]||(a[0]=e=>H.value.equipment=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>{var e;return[(v(!0),s(c,null,f(null==(e=E.value.find((e=>e.part===H.value.part)))?void 0:e.children,((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p(b(e.label),1)])),_:2},1024)))),128))]})),_:1}),i(M,null,{default:n((()=>{var e,a,l;return[(v(!0),s(c,null,f((null==(a=null==(e=E.value.find((e=>e.part===H.value.part)))?void 0:e.children[H.value.equipment[0]])?void 0:a.children)||(null==(l=E.value.find((e=>e.part===H.value.part)))?void 0:l.children.at(-1).children),((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p(b(e.label),1)])),_:2},1024)))),128))]})),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[p("原晶")])),_:1}),i(t,{class:"grow"}),i(w,{value:H.value.original,class:"popup-picker","immediate-change":"",onChange:a[1]||(a[1]=e=>H.value.original=e.detail.value)},{default:n((()=>[(v(!0),s(c,null,f(j.value,((e,a)=>(v(),m(M,{key:a},{default:n((()=>[2===H.value.part?(v(!0),s(c,{key:0},f(e.healthLabel,((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p(b(e),1)])),_:2},1024)))),128)):h("",!0),2!==H.value.part?(v(!0),s(c,{key:1},f(e.attackLabel,((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p(b(e),1)])),_:2},1024)))),128)):h("",!0)])),_:2},1024)))),128))])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[p("是否有皮肤")])),_:1}),i(t,{class:"grow"}),i($,{checked:H.value.hasSkin,onChange:a[2]||(a[2]=e=>H.value.hasSkin=e.detail.value)},null,8,["checked"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(q,{class:"yang-button outline block","hover-class":"hover",onClick:Z},{default:n((()=>[p("取消")])),_:1}),i(q,{class:"yang-button primary block","hover-class":"hover",onClick:Y},{default:n((()=>[p("保存")])),_:1})])),_:1}),i(t,{class:"h_safe"})])),_:1})):h("",!0)])),_:1},512),i(S,{ref_key:"editPilotPopup",ref:B,type:"bottom","safe-area":!1,"mask-click":!1},{default:n((()=>[F.value.visible?(v(),m(t,{key:0,class:"bg-color radius_t"},{default:n((()=>[i(t,{class:"d_flex px_4 py_3 items_center"},{default:n((()=>[i(t,{class:"font_bold"},{default:n((()=>[p("修改驾驶员（"+b(F.value.isMain?"主":"副")+"驾驶）",1)])),_:1}),i(t,{class:"grow"}),i(q,{class:"yang-button outline extra-small my-icon-close","hover-class":"hover",onClick:le})])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[p("驾驶员")])),_:1}),i(t,{class:"grow"}),i(w,{value:F.value.pilot,class:"popup-picker","immediate-change":"",onChange:a[3]||(a[3]=e=>F.value.pilot=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(v(!0),s(c,null,f(J.value,((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p(b(e.label),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[p("等级/潜能")])),_:1}),i(t,{class:"grow"}),i(w,{value:F.value.combatIndex,class:"popup-picker","immediate-change":"",onChange:a[4]||(a[4]=e=>F.value.combatIndex=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(v(!0),s(c,null,f(J.value[F.value.pilot[0]].children,((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p(b(e.label),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(q,{class:"yang-button outline block","hover-class":"hover",onClick:le},{default:n((()=>[p("取消")])),_:1}),i(q,{class:"yang-button primary block","hover-class":"hover",onClick:ae},{default:n((()=>[p("保存")])),_:1})])),_:1}),i(t,{class:"h_safe"})])),_:1})):h("",!0)])),_:1},512),i(S,{ref_key:"editCorePopup",ref:z,type:"bottom","safe-area":!1,"mask-click":!1},{default:n((()=>[G.value.visible?(v(),m(t,{key:0,class:"bg-color radius_t"},{default:n((()=>[i(t,{class:"d_flex px_4 py_3 items_center"},{default:n((()=>[i(t,{class:"font_bold"},{default:n((()=>[p("修改核心矩阵（核心"+b(G.value.editIndex+1)+"）",1)])),_:1}),i(t,{class:"grow"}),i(q,{class:"yang-button outline extra-small my-icon-close","hover-class":"hover",onClick:ie})])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[p("核心名称")])),_:1}),i(t,{class:"grow"}),i(w,{value:G.value.core,class:"popup-picker","immediate-change":"",onChange:a[5]||(a[5]=e=>G.value.core=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(v(!0),s(c,null,f(N.value,((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p(b(e.label)+" - "+b(e.pilot),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[p("等级/潜能")])),_:1}),i(t,{class:"grow"}),i(w,{value:G.value.combatIndex,class:"popup-picker","immediate-change":"",onChange:a[6]||(a[6]=e=>G.value.combatIndex=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(v(!0),s(c,null,f(N.value[G.value.core[0]].children,((e,a)=>(v(),m(t,{key:a,class:"d_flex center"},{default:n((()=>[p("Lv."+b(e.coreLevel)+" -- "+b(e.label),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(q,{class:"yang-button outline block","hover-class":"hover",onClick:ie},{default:n((()=>[p("取消")])),_:1}),i(q,{class:"yang-button primary block","hover-class":"hover",onClick:se},{default:n((()=>[p("保存")])),_:1})])),_:1}),i(t,{class:"h_safe"})])),_:1})):h("",!0)])),_:1},512),i(O,{content:"本页内容仅供参考，具体以官方数据为准。"}),i(P,{mp_weixin:"adunit-8c89cc4610403c81",mp_qq:"54ea1b2e68ecb1caa66494c8dc68d3b7"}),i(A,{version:""})])),_:1})],64)}}},[["__scopeId","data-v-7c74703d"]]);export{$ as default};
