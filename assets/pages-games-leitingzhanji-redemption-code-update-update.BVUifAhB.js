import{z as a,r as e,a as t,c as s,b as l,w as r,F as o,B as u,C as n,s as d,D as c,i,o as _,d as m,g as f,t as y,j as p,e as v,q as b,v as g,A as h,h as x}from"./index-DWyITiU3.js";const w={__name:"update",setup(w){const k=a("dayjs");uni.$sharePageTitle="编辑兑换码";const T=e({updateTime:"",rewardKeyMap:[],data:[]}),j=[Array.from({length:3},((a,e)=>({label:`${k().year()+e}年`,value:k().year()+e}))),Array.from({length:12},((a,e)=>({label:`${e+1}月`,value:e+1}))),Array.from({length:31},((a,e)=>({label:`${e+1}日`,value:e+1})))],$=e([0,0,0]);u({title:"加载中"}),n({url:"https://runjs.work/transformer/project?id=e73c35",sslVerify:!1,success:a=>{var e,t;const s=null==(t=null==(e=a.data.data)?void 0:e.js)?void 0:t.source;if(s){const a=JSON.parse(s.replace(/\n/g," ").replace(/&quot;/g,'"')),{updateTime:e,rewardKeyMap:t,data:l}=a;T.value.updateTime=e,T.value.rewardKeyMap=t,T.value.data=l.reverse()}else d({title:"资源加载异常",icon:"none"})},complete:()=>{c()}});const K=()=>{T.value.data.unshift({code:"",reward:["","","","","",""],invalidity:!1,isNew:!0})},A=()=>{const a=k();$.value=[0,a.hour(),a.minute()],nowTimestamp=a.valueOf()-a.hour()*hour-a.minute()*minute},C=a=>{const{value:e}=a.detail,{key:t}=a.currentTarget.dataset,s={},l=[24*hour,hour,minute];T.value.forEach((a=>s[a.key]=a.date));const r=j.map((a=>a.map((a=>a.value))));s[t]=e.reduce(((a,e,t)=>a+r[t][e]*l[t]),nowTimestamp),b(storageKey,s),pageInit()};return(a,e)=>{const u=i,n=g,d=h,c=t("my-bottom-safety-space");return _(),s(o,null,[l(u,{class:"pt_4"},{default:r((()=>[l(d,{class:"cursor_default",mode:"multiSelector","range-key":"label",value:$.value,range:j,onClick:A,onChange:C},{default:r((()=>[l(u,{class:"mx_4 mb_4 shadow radius bg-color"},{default:r((()=>[l(u,{class:"d_flex px_4 items_center"},{default:r((()=>[l(u,{class:"font_bold grow"},{default:r((()=>[m("时间")])),_:1}),T.value.updateTime?(_(),f(u,{key:0},{default:r((()=>[l(n,{class:"text-info text_base"},{default:r((()=>[m(y(T.value.updateTime),1)])),_:1})])),_:1})):p("",!0),l(u,{class:"my-icon my-icon-chevron-right text_xxl"})])),_:1})])),_:1})])),_:1},8,["value"]),l(u,{class:"mx_4 mb_4 shadow radius bg-color"},{default:r((()=>[(_(!0),s(o,null,v(T.value.data,((a,e)=>(_(),f(u,{key:e,class:x(["d_flex items_center text_base px_4 p_relative",0===e?"radius_t border_b":e===T.value.data.length?"radius_b":"border_b"]),"hover-class":"bg-hover","data-index":e},{default:r((()=>[l(u,{class:"py_4"},{default:r((()=>[m(y(a.code),1)])),_:2},1024),l(u,{class:"grow"}),l(u,{class:"text-info text_right"},{default:r((()=>[m(y(a.reward.map(((a,e)=>((a,e)=>e?`${e}${T.value.rewardKeyMap[a]||""}`:"")(e,a))).filter((a=>a)).join("，")),1)])),_:2},1024),a.invalidity?(_(),f(u,{key:0,class:"yang-badge ribbon info"},{default:r((()=>[l(u,{class:"content basic"},{default:r((()=>[m("已失效")])),_:1})])),_:1})):p("",!0),a.isNew?(_(),f(u,{key:1,class:"yang-badge ribbon"},{default:r((()=>[l(u,{class:"content basic"},{default:r((()=>[m("NEW")])),_:1})])),_:1})):p("",!0),l(u,{class:"my-icon my-icon-chevron-right text_xxl"})])),_:2},1032,["class","data-index"])))),128))])),_:1})])),_:1}),l(u,{class:"plus yang-fab yang-button primary circle",onClick:K},{default:r((()=>[l(u,{class:"my-icon my-icon-plus text_xxl"})])),_:1}),l(c,{version:""})],64)}}};export{w as default};
