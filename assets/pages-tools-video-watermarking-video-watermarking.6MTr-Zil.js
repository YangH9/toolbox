import{_ as e,v as t,x as a,g as s,o as l,w as o,a as i,i as n,y as r,n as c,h as u,z as d,c as m,A as h,I as p,F as y,r as f,B as _,l as v,C as g,D as b,E as k,s as x,G as w,b as C,e as S,m as I,f as $,t as B,H as F,d as P,J as V,j as M,u as j,K as T,L as E,M as z,q as Y,p as N}from"./index-CNm5Uijj.js";import{_ as q}from"./uni-icons.BxViHhJf.js";function D(e){let t="";for(let a in e){t+=`${a}:${e[a]};`}return t}const H=e({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let t="";for(let a in e)e[a]&&(t+=`${a} `);return t}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return D({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return D({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px",...this.styles})}},watch:{value(e){this.val=null!==e?e:""},modelValue(e){this.val=null!==e?e:""},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=""},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let t=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(t=this.trimStr(t)),"string"==typeof this.trim&&(t=this.trimStr(t,this.trim))),this.errMsg&&(this.errMsg=""),this.val=t,this.$emit("input",t),this.$emit("update:modelValue",t)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,t="both")=>"both"===t?e.trim():"left"===t?e.trimLeft():"right"===t?e.trimRight():"start"===t?e.trimStart():"end"===t?e.trimEnd():"all"===t?e.replace(/\s+/g,""):e}},[["render",function(e,f,_,v,g,b){const k=t(a("uni-icons"),q),x=h,w=p,C=n;return l(),s(C,{class:c(["uni-easyinput",{"uni-easyinput-error":b.msg}]),style:r(b.boxStyle)},{default:o((()=>[i(C,{class:c(["uni-easyinput__content",b.inputContentClass]),style:r(b.inputContentStyle)},{default:o((()=>[_.prefixIcon?(l(),s(k,{key:0,class:"content-clear-icon",type:_.prefixIcon,color:"#c0c4cc",onClick:f[0]||(f[0]=e=>b.onClickIcon("prefix")),size:"22"},null,8,["type"])):u("",!0),d(e.$slots,"left",{},void 0,!0),"textarea"===_.type?(l(),s(x,{key:1,class:c(["uni-easyinput__content-textarea",{"input-padding":_.inputBorder}]),name:_.name,value:g.val,placeholder:_.placeholder,placeholderStyle:_.placeholderStyle,disabled:_.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:b.inputMaxlength,focus:g.focused,autoHeight:_.autoHeight,"cursor-spacing":_.cursorSpacing,"adjust-position":_.adjustPosition,onInput:b.onInput,onBlur:b._Blur,onFocus:b._Focus,onConfirm:b.onConfirm,onKeyboardheightchange:b.onkeyboardheightchange},null,8,["class","name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position","onInput","onBlur","onFocus","onConfirm","onKeyboardheightchange"])):(l(),s(w,{key:2,type:"password"===_.type?"text":_.type,class:"uni-easyinput__content-input",style:r(b.inputStyle),name:_.name,value:g.val,password:!g.showPassword&&"password"===_.type,placeholder:_.placeholder,placeholderStyle:_.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:_.disabled,maxlength:b.inputMaxlength,focus:g.focused,confirmType:_.confirmType,"cursor-spacing":_.cursorSpacing,"adjust-position":_.adjustPosition,onFocus:b._Focus,onBlur:b._Blur,onInput:b.onInput,onConfirm:b.onConfirm,onKeyboardheightchange:b.onkeyboardheightchange},null,8,["type","style","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position","onFocus","onBlur","onInput","onConfirm","onKeyboardheightchange"])),"password"===_.type&&_.passwordIcon?(l(),m(y,{key:3},[b.isVal?(l(),s(k,{key:0,class:c(["content-clear-icon",{"is-textarea-icon":"textarea"===_.type}]),type:g.showPassword?"eye-slash-filled":"eye-filled",size:22,color:g.focusShow?_.primaryColor:"#c0c4cc",onClick:b.onEyes},null,8,["class","type","color","onClick"])):u("",!0)],64)):u("",!0),_.suffixIcon?(l(),m(y,{key:4},[_.suffixIcon?(l(),s(k,{key:0,class:"content-clear-icon",type:_.suffixIcon,color:"#c0c4cc",onClick:f[1]||(f[1]=e=>b.onClickIcon("suffix")),size:"22"},null,8,["type"])):u("",!0)],64)):(l(),m(y,{key:5},[_.clearable&&b.isVal&&!_.disabled&&"textarea"!==_.type?(l(),s(k,{key:0,class:c(["content-clear-icon",{"is-textarea-icon":"textarea"===_.type}]),type:"clear",size:_.clearSize,color:b.msg?"#dd524d":g.focusShow?_.primaryColor:"#c0c4cc",onClick:b.onClear},null,8,["class","size","color","onClick"])):u("",!0)],64)),d(e.$slots,"right",{},void 0,!0)])),_:3},8,["class","style"])])),_:3},8,["class","style"])}],["__scopeId","data-v-fe257430"]]),K="app-video-analysis-watch-ad",L=e({__name:"video-watermarking",setup(e){uni.$sharePageTitle="短视频去水印";const r=w("dayjs"),d=!0,h="prod-9g9tuo2i7f723a6a",p="flask-ao4d",q=f(""),D=f({}),L=[{key:"video",name:"视频"},{key:"image",name:"图片"},{key:"title",name:"标题"}],O=f("video");_((e=>{var t;try{const t=v("app-video-analysis-history-list")||[];if(void 0!==e.index){const a=t[Number(e.index)];q.value=a.sharelink,A()}}catch(a){q.value=""}null==(t=uni.cloud)||t.init()})),g((()=>{}));const R=()=>{V({success:e=>{q.value=e.data},fail:()=>{}})},X=()=>{q.value=""},A=async()=>{if(b({title:"解析中……",mask:!0}),!q.value)return k(),void x({title:"请输入正确的链接。",icon:"none"});x({title:"本功能暂支支持《微信小程序》版本。",icon:"none"})},G=async()=>{const e=v(K);if(e&&e===r().format("YYYY-MM-DD"))return Promise.resolve(!0);if((await Y({title:"提示",content:"观看一次广告，今日无限保存。",cancelText:"下次再说",confirmText:"观看广告"})).confirm){return await new Promise(((e,t)=>{e(!1)}))?(N(K,r().format("YYYY-MM-DD")),Promise.resolve(!0)):Promise.resolve(!1)}return Promise.resolve(!1)},J=async e=>{if(!(await G()))return;let t="";switch(e){case"video":t=D.value.video;break;case"image":t=D.value.cover;break;case"title":t=D.value.desc}j({data:t,fail:()=>{x({title:"复制失败，请检查设备微信权限。",icon:"none"})}})},U=async e=>{var t;if(await G())try{b({title:"下载中……",mask:!0});let a="";switch(e){case"video":a=D.value.video;break;case"image":a=D.value.cover}let s=null;if(!1===D.value.is_video_in_white&&d){const l=await wx.cloud.callContainer({path:"/downloadproxy/oss/",config:{env:h},header:{"X-WX-SERVICE":p,"content-type":"application/json"},method:"POST",data:{source:D.value.source,id:D.value.aweme_id,type:e,url:a}});if(200!==l.statusCode)throw new Error("资源代理失败");a=null==(t=l.data.data)?void 0:t.file_id,s=await wx.cloud.downloadFile({fileID:a})}else s=await T({url:a});200===s.statusCode?"video"===e?E({filePath:s.tempFilePath,success:e=>{k(),x({title:"视频保存成功",icon:"success"})},fail(e){k(),x({title:"视频保存失败",icon:"error"})}}):z({filePath:s.tempFilePath,success:e=>{k(),x({title:"图片保存成功",icon:"success"})},fail(e){k(),x({title:"图片保存失败",icon:"error"})}}):(k(),x({title:"一键下载失败，请复制链接至浏览器下载。",icon:"none"}))}catch(a){k(),x({title:"资源获取失败。",icon:"error"})}},W=e=>{M({url:`/pages/tools/video-watermarking/${e}`})};return(e,r)=>{const d=C("my-page-header"),h=C("my-ad-custom"),p=n,f=C("my-divider"),_=t(a("uni-easyinput"),H),v=I,g=F,b=P,k=C("my-bottom-safety-space");return l(),m(y,null,[i(d),D.value.video&&!D.value.msg?(l(),s(p,{key:0},{default:o((()=>[i(h,{mp_weixin:"adunit-3eaf9cea980e809f",mp_qq:"c74f0b30cbf1b82004c9c785b7afc1c0",custom_class:"pt_4 mx_4"})])),_:1})):u("",!0),i(p,{class:"pt_4"},{default:o((()=>[i(p,{class:"notice d_flex items_center px_4 py_2 mx_4 mb_4 radius"},{default:o((()=>[i(p,{class:"my-icon my-icon-sound mr_2 text-primary"}),i(p,{class:""},{default:o((()=>[S("本功能暂支支持《微信小程序》版本。")])),_:1})])),_:1}),i(f,{content:"视频归平台及作者所有，本应用不存储任何视频及图片。"}),i(p,{class:"video-watermarking-textarea mx_4 mb_4"},{default:o((()=>[i(_,{type:"textarea",modelValue:q.value,"onUpdate:modelValue":r[0]||(r[0]=e=>q.value=e),maxlength:"1000",placeholder:"请输入视频链接，目前已支持抖音和快手相关视频。"},null,8,["modelValue"])])),_:1}),i(p,{class:"d_flex mx_4 mb_4"},{default:o((()=>[i(v,{class:"yang-button primary outline block","hover-class":"hover",onClick:R},{default:o((()=>[i(p,{class:"my-icon my-icon-file-copy mr_2"}),i(p,{class:""},{default:o((()=>[S("一键粘贴")])),_:1})])),_:1}),i(v,{class:"yang-button danger outline block","hover-class":"hover",onClick:X},{default:o((()=>[i(p,{class:"my-icon my-icon-delete mr_2"}),i(p,{class:""},{default:o((()=>[S("清空")])),_:1})])),_:1})])),_:1}),i(p,{class:"mx_4 mb_4"},{default:o((()=>[i(v,{class:"yang-button primary block","hover-class":"hover",onClick:A},{default:o((()=>[i(p,{class:"my-icon my-icon-rocket mr_2"}),i(p,{class:""},{default:o((()=>[S("立即去水印")])),_:1})])),_:1})])),_:1}),i(p,{class:"d_flex mx_4 mb_4"},{default:o((()=>[i(v,{class:"yang-button primary outline small block","hover-class":"hover",onClick:r[1]||(r[1]=e=>W("history"))},{default:o((()=>[i(p,{class:"my-icon my-icon-list mr_1"}),i(p,{class:""},{default:o((()=>[S("解析记录")])),_:1})])),_:1}),i(v,{class:"yang-button primary outline small block","hover-class":"hover",onClick:r[2]||(r[2]=e=>W("questions"))},{default:o((()=>[i(p,{class:"my-icon my-icon-list mr_1"}),i(p,{class:""},{default:o((()=>[S("常见问题")])),_:1})])),_:1}),i(v,{class:"yang-button primary outline small block","hover-class":"hover",onClick:r[3]||(r[3]=e=>W("tutorial"))},{default:o((()=>[i(p,{class:"my-icon my-icon-list mr_1"}),i(p,{class:""},{default:o((()=>[S("使用教程")])),_:1})])),_:1})])),_:1}),D.value.video?u("",!0):(l(),s(f,{key:0,content:"若首次解析失败请等待十秒左右重试。"})),D.value.video&&!D.value.msg?(l(),s(p,{key:1,class:"mx_4 pt_2 shadow radius bg-color mb_4"},{default:o((()=>[i(p,{class:"yang-nav-tabs evenly border_b"},{default:o((()=>[(l(),m(y,null,$(L,((e,t)=>i(p,{key:t,class:c(["yang-tabs__item py_2",{active:e.key==O.value}]),onClick:t=>{return a=e.key,void(O.value=a);var a}},{default:o((()=>[S(B(e.name),1)])),_:2},1032,["class","onClick"]))),64))])),_:1}),"video"===O.value?(l(),s(p,{key:0,class:"body py_4"},{default:o((()=>[i(p,{class:"mb_4"},{default:o((()=>[i(p,{class:"d_flex px_4"},{default:o((()=>[i(g,{src:D.value.video,poster:D.value.cover,class:"media grow"},null,8,["src","poster"])])),_:1})])),_:1}),i(p,{class:"d_flex items_center content_between px_4"},{default:o((()=>[i(v,{class:"yang-button primary outline m_0","hover-class":"hover",onClick:r[4]||(r[4]=e=>J("video"))},{default:o((()=>[i(p,{class:"my-icon my-icon-file-copy mr_2"}),i(p,{class:""},{default:o((()=>[S("复制链接")])),_:1})])),_:1}),i(v,{class:"yang-button primary m_0","hover-class":"hover",onClick:r[5]||(r[5]=e=>U("video"))},{default:o((()=>[D.value.is_video_in_white?(l(),s(p,{key:0,class:"my-icon my-icon-cloud-download mr_2"})):(l(),s(p,{key:1,class:"my-icon my-icon-file-download mr_2"})),i(p,{class:""},{default:o((()=>[S("下载视频")])),_:1})])),_:1})])),_:1})])),_:1})):u("",!0),"image"===O.value?(l(),s(p,{key:1,class:"body py_4"},{default:o((()=>[i(p,{class:"mb_4"},{default:o((()=>[i(p,{class:"d_flex px_4"},{default:o((()=>[i(b,{src:D.value.cover,mode:"aspectFit",class:"media grow"},null,8,["src"])])),_:1})])),_:1}),i(p,{class:"d_flex content_between px_4"},{default:o((()=>[i(v,{class:"yang-button primary outline m_0","hover-class":"hover",onClick:r[6]||(r[6]=e=>J("image"))},{default:o((()=>[i(p,{class:"my-icon my-icon-file-copy mr_2"}),i(p,{class:""},{default:o((()=>[S("复制链接")])),_:1})])),_:1}),i(v,{class:"yang-button primary m_0","hover-class":"hover",onClick:r[7]||(r[7]=e=>U("image"))},{default:o((()=>[D.value.is_video_in_white?(l(),s(p,{key:0,class:"my-icon my-icon-cloud-download mr_2"})):(l(),s(p,{key:1,class:"my-icon my-icon-file-download mr_2"})),i(p,{class:""},{default:o((()=>[S("下载图片")])),_:1})])),_:1})])),_:1})])),_:1})):u("",!0),"title"===O.value?(l(),s(p,{key:2,class:"body py_4"},{default:o((()=>[i(p,{class:"video-watermarking-textarea px_4 mb_4"},{default:o((()=>[i(_,{type:"textarea",value:D.value.desc,maxlength:"1000"},null,8,["value"])])),_:1}),i(p,{class:"d_flex px_4"},{default:o((()=>[i(v,{class:"yang-button primary outline m_0",onClick:r[8]||(r[8]=e=>J("title"))},{default:o((()=>[i(p,{class:"my-icon my-icon-file-copy mr_2"}),i(p,{class:""},{default:o((()=>[S("复制标题")])),_:1})])),_:1})])),_:1})])),_:1})):u("",!0)])),_:1})):u("",!0),i(h,{mp_weixin:"adunit-4487e043d6b98f83",mp_qq:"54ea1b2e68ecb1caa66494c8dc68d3b7"}),i(k,{version:""})])),_:1})],64)}}},[["__scopeId","data-v-609fd5d8"]]);export{L as default};
