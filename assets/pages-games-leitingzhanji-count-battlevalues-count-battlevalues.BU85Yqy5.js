import{_ as e,r as a,l,a4 as t,c as s,a as i,w as n,F as c,i as r,b as o,v as u,x as d,o as _,e as v,t as p,f as b,g as f,n as m,h as x,O as h,m as g,aj as y,ak as k,al as I,p as L}from"./index-CBBPq_Me.js";import{_ as C}from"./uni-popup.Bd8uHF-u.js";import{a as q,b as M}from"./config.Dny4K3GL.js";import{f as w}from"./data-all.r1MXBCvn.js";const $=e({__name:"count-battlevalues",setup(e){uni.$sharePageTitle=`战力计算器-${q}`;const $=`${M}-count-battlevalues`,S=w.partData.map((e=>e.combat)),O={};w.driverOption.position.forEach((e=>O[e.value]=e.combat));const P={};w.driverOption.core.forEach((e=>P[e.value]=e.combat));const E=a([]),j=a(w.originalCrystalData.combatList),A=a({label:"皮肤",attack:50,health:1e3}),J=a([]),N=a([]),T=a(l($)||JSON.parse(JSON.stringify({e:[{p:1,e:100,g:10,o:[3,3,3,3],s:1},{p:2,e:100,g:10,o:[3,3,3,3],s:0},{p:3,e:100,g:10,o:[3,3,3,3],s:1},{p:4,e:100,g:10,o:[3,3,3,3],s:1}],p:[{p:5,c:25,m:1},{p:4,c:25,m:0},{p:7,c:25,m:0},{p:9,c:25,m:0}],c:[{c:5,m:20},{c:7,m:20},{c:9,m:20}]}))),X=a(null),D=a({visible:!1,editIndex:0,part:0,partLabel:"",equipment:[0,0],original:[0,0,0,0],hasSkin:!1}),H=a(null),F=a({visible:!1,editIndex:0,isMain:!1,pilot:[0],combatIndex:[0]}),z=a(null),B=a({visible:!1,editIndex:0,core:[0],combatIndex:[0]}),G=a({attack:0,health:0,combat:0}),K=a([]),Q=a([]),R=a([]);(()=>{const{partData:e,planeOption:a,aresOption:l,driverOption:t,planeList:s,aresList:i,driverList:n}=JSON.parse(JSON.stringify(w));E.value=e.map(((e,t)=>({label:e.label,part:e.value,children:[s.map(((l,s)=>l.part[t].quality.map(((t,s)=>{let i=a.quality[s];return{label:t,partLabel:e.label,key:`plane-${e.value}-${l.suit}-${i.value}`,part:e.value,quality:i.value,suit:l.suit,children:i.gradation.map(((e,a)=>{const t=e.value?e.isMax?"MAX":`+${e.value}`:"",n=l.combat[s][a].at(-1);return{label:`${i.label}${t}`,value:e.value,isMax:e.isMax,level:e.maxLevel,attack:n.attack,health:n.health}}))}})))),i.map(((a,s)=>a.part[t].quality.map(((t,s)=>{let i=l.quality[s];return{label:t,partLabel:e.label,key:`ares-${e.value}-${a.suit}-${i.value}`,part:e.value,quality:i.value,suit:a.suit,children:i.gradation.map(((e,l)=>{const t=e.value?e.isMax?"MAX":`+${e.value}`:"",n=a.combat[s][l].at(-1);return{label:`${i.label}${t}`,value:e.value,isMax:e.isMax,level:e.maxLevel,attack:n.basicAttack+n.syncAttack,health:n.basicHealth+n.syncHealth}}))}}))))].flat(2)}))),J.value=n.map((e=>{const a=e.potential.length;return{label:e.title,star:e.star,key:"driver",children:t.quality.map(((a,l)=>{const t=e.combat[l].at(-1);return{label:a.label,quality:a.value,level:t.level,combat:t.part}})).concat(e.potential.map(((e,l)=>({label:"潜能"+(l+1===a?"MAX":`${l+1}/${a}`),quality:4,level:90,combat:e.part}))))}})),N.value=n.map((e=>{const a=e.potential.length;return{label:e.stunt,pilot:e.title,star:e.star,key:"core",children:e.potential.map(((e,l)=>({coreLevel:e.coreLevel,label:"潜能"+(l+1===a?"MAX":`${l+1}/${a}`),combat:e.part}))).filter((e=>e.coreLevel))}}))})();t((()=>{(()=>{const{e:e,p:a,c:l}=T.value;e.forEach(((e,a)=>{D.value={visible:!1,editIndex:a,part:e.p,partLabel:"",equipment:[e.e,e.g],original:e.o,hasSkin:!!e.s},W()})),a.forEach(((e,a)=>{F.value={visible:!1,editIndex:a,isMain:!!e.m,pilot:[e.p],combatIndex:[e.c]},ee()})),l.forEach(((e,a)=>{B.value={visible:!1,editIndex:a,core:[e.c],combatIndex:[e.m]},te()}))})()}));const U=()=>{const e=[0,0,0,0];K.value.forEach(((a,l)=>{e[l]=a.combat,a.hasSkin&&(e[l]+=2===a.part?A.value.health:A.value.attack),Q.value.forEach((a=>{e[l]+=a.partCombat[l]})),R.value.forEach((a=>{e[l]+=a.partCombat[l]}));const t=a.originalCrystal.filter((e=>e.isPercentage)).reduce(((e,a)=>e+a.value),0),s=a.originalCrystal.filter((e=>!e.isPercentage)).reduce(((e,a)=>e+a.value),0);e[l]+=e[l]*t,e[l]+=s})),G.value.combat=e.reduce(((e,a,l)=>e+a*S[l]),0)};U();const V=e=>{const a=e.currentTarget.dataset.index,l=JSON.parse(JSON.stringify(K.value[a]));D.value={visible:!0,editIndex:a,part:l.part,partLabel:l.partLabel,equipment:[l.equiIndex,l.gradaIndex],original:l.originalIndex,hasSkin:l.hasSkin},X.value.open()},W=()=>{const e=D.value,a=E.value.find((a=>a.part===e.part)),l=a.children[e.equipment[0]]??a.children.at(-1),t=l.children[e.equipment[1]]??l.children.at(-1),s=j.value,i={label:l.label,key:l.key,part:l.part,partLabel:l.partLabel,gradationLabel:t.label,level:t.level,combat:2===e.part?t.health:t.attack,equiIndex:e.equipment[0],gradaIndex:e.equipment[1],originalIndex:e.original,originalCrystal:s.map(((a,l)=>{var t,s,i,n;return 2===e.part?{label:a.healthLabel[null==(t=e.original)?void 0:t[l]]??a.healthLabel.at(-1),value:a.health[null==(s=e.original)?void 0:s[l]]??a.health.at(-1),isPercentage:!!a.isPercentage}:{label:a.attackLabel[null==(i=e.original)?void 0:i[l]]??a.attackLabel.at(-1),value:a.attack[null==(n=e.original)?void 0:n[l]]??a.attack.at(-1),isPercentage:!!a.isPercentage}})),hasSkin:!!e.hasSkin};if(K.value[e.editIndex]=i,e.visible){const a={p:l.part,e:e.equipment[0],g:e.equipment[1],o:e.original,s:+e.hasSkin};T.value.e[e.editIndex]=a,Y(),ie()}U()},Y=()=>{D.value.visible=!1,X.value.close()},Z=e=>{const a=e.currentTarget.dataset.index,l=Q.value[a];F.value={visible:!0,editIndex:a,isMain:l.isMain,pilot:[l.index],combatIndex:[l.combatIndex]},H.value.open()},ee=()=>{const e=F.value,a=J.value[e.pilot[0]]??J.value.at(-1),l=a.children[e.combatIndex[0]]??a.children.at(-1),t={key:a.key,label:a.label,gradationLabel:l.label,level:l.level,index:e.pilot[0],combatIndex:e.combatIndex[0],isMain:e.isMain,quality:l.quality,combat:l.combat.reduce(((a,l,t)=>a+l*O[e.isMain]*S[t]),0),partCombat:l.combat.map((a=>a*O[e.isMain]))};if(Q.value[e.editIndex]=t,e.visible){const a={p:e.pilot[0],c:e.combatIndex[0],m:+e.isMain};T.value.p[e.editIndex]=a,ae(),ie()}U()},ae=()=>{F.value.visible=!1,H.value.close()},le=e=>{const a=e.currentTarget.dataset.index,l=R.value[a];B.value={visible:!0,editIndex:a,core:[l.index],combatIndex:[l.combatIndex]},z.value.open()},te=()=>{const e=B.value,a=N.value[e.core[0]]??N.value.at(-1),l=a.children[e.combatIndex[0]]??a.children.at(-1),t={key:a.key,label:a.label,pilot:a.pilot,gradationLabel:l.label,level:l.coreLevel,index:e.core[0],combatIndex:e.combatIndex[0],type:e.editIndex+1,combat:l.combat.reduce(((e,a,t)=>e+a*P[l.coreLevel]*S[t]),0),partCombat:l.combat.map((e=>e*P[l.coreLevel]))};if(R.value[e.editIndex]=t,e.visible){const a={c:e.core[0],m:e.combatIndex[0]};T.value.c[e.editIndex]=a,se(),ie()}U()},se=()=>{B.value.visible=!1,z.value.close()},ie=()=>{L($,T.value)};return(e,a)=>{const l=o("my-page-header"),t=r,L=h,q=g,M=k,w=y,$=I,S=u(d("uni-popup"),C),O=o("my-divider"),P=o("my-ad-custom"),A=o("my-bottom-safety-space");return _(),s(c,null,[i(l),i(t,{class:"pt_4"},{default:n((()=>[i(t,{class:"mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[i(t,{class:"d_flex px_4 items_center"},{default:n((()=>[i(t,{class:"py_4 font_bold"},{default:n((()=>[v("总战力")])),_:1}),i(t,{class:"grow"}),i(t,{class:"py_4"},{default:n((()=>[v(p(Math.round(G.value.combat)),1)])),_:1})])),_:1})])),_:1}),i(t,{class:"mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[(_(!0),s(c,null,b(K.value,((e,a)=>(_(),f(t,{key:a,class:m(["d_flex items_center text_base px_4 border_b p_relative",0===a?"radius_t":a===K.value.length?"radius_b":""]),"hover-class":"bg-hover","data-index":a,onClick:V},{default:n((()=>[i(t,{class:"my_4 p_relative"},{default:n((()=>[i(t,null,{default:n((()=>[v(p(e.label||e.partLabel),1),i(L,{class:"text_xs text-info"},{default:n((()=>[v(" - "+p(e.gradationLabel)+" - Lv."+p(e.level),1)])),_:2},1024)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[v(p(e.originalCrystal.map((e=>e.label)).join("、")),1)])),_:2},1024),e.hasSkin?(_(),f(t,{key:0,class:"yang-badge basic count circle warning"},{default:n((()=>[v("有皮肤")])),_:1})):x("",!0)])),_:2},1024),i(t,{class:"grow"}),i(t,{class:"text-info text_right"},{default:n((()=>[v(p(e.combat),1)])),_:2},1024),i(t,{class:"yang-badge ribbon"},{default:n((()=>[i(t,{class:"content basic"},{default:n((()=>[v(p(e.partLabel),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","data-index"])))),128))])),_:1}),i(t,{class:"d_flex content_between mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[(_(!0),s(c,null,b(Q.value,((e,a)=>(_(),f(t,{key:a,class:m(["d_flex items_center grow text_base px_2 p_relative",0===a?"radius_l border_r":a===Q.value.length?"radius_r":"border_r"]),"hover-class":"bg-hover","data-index":a,onClick:Z},{default:n((()=>[i(t,{class:"my_4"},{default:n((()=>[i(t,null,{default:n((()=>[v(p(e.label||(e.isMain?"主驾驶":"副驾驶")),1)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[v(p(e.gradationLabel),1)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[v("Lv."+p(e.level),1)])),_:2},1024),i(t,{class:"text-info"},{default:n((()=>[v(p(Math.round(e.combat)),1)])),_:2},1024)])),_:2},1024),i(t,{class:"yang-badge ribbon"},{default:n((()=>[i(t,{class:"content basic"},{default:n((()=>[v(p(e.isMain?"主驾驶":"副驾驶"),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","data-index"])))),128))])),_:1}),i(t,{class:"d_flex content_between mx_4 mb_4 shadow radius bg-color"},{default:n((()=>[(_(!0),s(c,null,b(R.value,((e,a)=>(_(),f(t,{key:a,class:m(["d_flex items_center grow text_base px_4 border_b p_relative",0===a?"radius_t border_r":a===R.value.length?"radius_b":"border_r"]),"hover-class":"bg-hover","data-index":a,onClick:le},{default:n((()=>[i(t,{class:"my_4 p_relative"},{default:n((()=>[i(t,null,{default:n((()=>[v(p(e.label),1)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[v(p(e.pilot),1)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[v("Lv."+p(e.level),1)])),_:2},1024),i(t,{class:"text_xs text-info"},{default:n((()=>[v(p(e.gradationLabel),1)])),_:2},1024),i(t,{class:"text-info"},{default:n((()=>[v(p(Math.round(e.combat)),1)])),_:2},1024)])),_:2},1024),i(t,{class:"yang-badge ribbon"},{default:n((()=>[i(t,{class:"content basic"},{default:n((()=>[v("核心"+p(e.type),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","data-index"])))),128))])),_:1}),i(S,{ref_key:"editEquipmentPopup",ref:X,type:"bottom","safe-area":!1,"mask-click":!1},{default:n((()=>[D.value.visible?(_(),f(t,{key:0,class:"bg-color radius_t"},{default:n((()=>[i(t,{class:"d_flex px_4 py_3 items_center"},{default:n((()=>[i(t,{class:"font_bold"},{default:n((()=>[v("修改装备("+p(D.value.partLabel)+")",1)])),_:1}),i(t,{class:"grow"}),i(q,{class:"yang-button outline extra-small my-icon my-icon-close","hover-class":"hover",onClick:Y})])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[v("装备")])),_:1}),i(t,{class:"grow"}),i(w,{value:D.value.equipment,class:"popup-picker","immediate-change":"",onChange:a[0]||(a[0]=e=>D.value.equipment=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>{var e;return[(_(!0),s(c,null,b(null==(e=E.value.find((e=>e.part===D.value.part)))?void 0:e.children,((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v(p(e.label),1)])),_:2},1024)))),128))]})),_:1}),i(M,null,{default:n((()=>{var e,a,l;return[(_(!0),s(c,null,b((null==(a=null==(e=E.value.find((e=>e.part===D.value.part)))?void 0:e.children[D.value.equipment[0]])?void 0:a.children)||(null==(l=E.value.find((e=>e.part===D.value.part)))?void 0:l.children.at(-1).children),((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v(p(e.label),1)])),_:2},1024)))),128))]})),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[v("原晶")])),_:1}),i(t,{class:"grow"}),i(w,{value:D.value.original,class:"popup-picker","immediate-change":"",onChange:a[1]||(a[1]=e=>D.value.original=e.detail.value)},{default:n((()=>[(_(!0),s(c,null,b(j.value,((e,a)=>(_(),f(M,{key:a},{default:n((()=>[2===D.value.part?(_(!0),s(c,{key:0},b(e.healthLabel,((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v(p(e),1)])),_:2},1024)))),128)):x("",!0),2!==D.value.part?(_(!0),s(c,{key:1},b(e.attackLabel,((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v(p(e),1)])),_:2},1024)))),128)):x("",!0)])),_:2},1024)))),128))])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[v("是否有皮肤")])),_:1}),i(t,{class:"grow"}),i($,{checked:D.value.hasSkin,onChange:a[2]||(a[2]=e=>D.value.hasSkin=e.detail.value)},null,8,["checked"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(q,{class:"yang-button outline block","hover-class":"hover",onClick:Y},{default:n((()=>[v("取消")])),_:1}),i(q,{class:"yang-button primary block","hover-class":"hover",onClick:W},{default:n((()=>[v("保存")])),_:1})])),_:1}),i(t,{class:"h_safe"})])),_:1})):x("",!0)])),_:1},512),i(S,{ref_key:"editPilotPopup",ref:H,type:"bottom","safe-area":!1,"mask-click":!1},{default:n((()=>[F.value.visible?(_(),f(t,{key:0,class:"bg-color radius_t"},{default:n((()=>[i(t,{class:"d_flex px_4 py_3 items_center"},{default:n((()=>[i(t,{class:"font_bold"},{default:n((()=>[v("修改驾驶员（"+p(F.value.isMain?"主":"副")+"驾驶）",1)])),_:1}),i(t,{class:"grow"}),i(q,{class:"yang-button outline extra-small my-icon my-icon-close","hover-class":"hover",onClick:ae})])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[v("驾驶员")])),_:1}),i(t,{class:"grow"}),i(w,{value:F.value.pilot,class:"popup-picker","immediate-change":"",onChange:a[3]||(a[3]=e=>F.value.pilot=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(_(!0),s(c,null,b(J.value,((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v(p(e.label),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[v("等级/潜能")])),_:1}),i(t,{class:"grow"}),i(w,{value:F.value.combatIndex,class:"popup-picker","immediate-change":"",onChange:a[4]||(a[4]=e=>F.value.combatIndex=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(_(!0),s(c,null,b(J.value[F.value.pilot[0]].children,((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v(p(e.label),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(q,{class:"yang-button outline block","hover-class":"hover",onClick:ae},{default:n((()=>[v("取消")])),_:1}),i(q,{class:"yang-button primary block","hover-class":"hover",onClick:ee},{default:n((()=>[v("保存")])),_:1})])),_:1}),i(t,{class:"h_safe"})])),_:1})):x("",!0)])),_:1},512),i(S,{ref_key:"editCorePopup",ref:z,type:"bottom","safe-area":!1,"mask-click":!1},{default:n((()=>[B.value.visible?(_(),f(t,{key:0,class:"bg-color radius_t"},{default:n((()=>[i(t,{class:"d_flex px_4 py_3 items_center"},{default:n((()=>[i(t,{class:"font_bold"},{default:n((()=>[v("修改核心矩阵（核心"+p(B.value.editIndex+1)+"）",1)])),_:1}),i(t,{class:"grow"}),i(q,{class:"yang-button outline extra-small my-icon my-icon-close","hover-class":"hover",onClick:se})])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[v("核心名称")])),_:1}),i(t,{class:"grow"}),i(w,{value:B.value.core,class:"popup-picker","immediate-change":"",onChange:a[5]||(a[5]=e=>B.value.core=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(_(!0),s(c,null,b(N.value,((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v(p(e.label)+" - "+p(e.pilot),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(t,{class:"title"},{default:n((()=>[v("等级/潜能")])),_:1}),i(t,{class:"grow"}),i(w,{value:B.value.combatIndex,class:"popup-picker","immediate-change":"",onChange:a[6]||(a[6]=e=>B.value.combatIndex=e.detail.value)},{default:n((()=>[i(M,null,{default:n((()=>[(_(!0),s(c,null,b(N.value[B.value.core[0]].children,((e,a)=>(_(),f(t,{key:a,class:"d_flex center"},{default:n((()=>[v("Lv."+p(e.coreLevel)+" -- "+p(e.label),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),i(t,{class:"d_flex px_4 py_3 items_center border_t"},{default:n((()=>[i(q,{class:"yang-button outline block","hover-class":"hover",onClick:se},{default:n((()=>[v("取消")])),_:1}),i(q,{class:"yang-button primary block","hover-class":"hover",onClick:te},{default:n((()=>[v("保存")])),_:1})])),_:1}),i(t,{class:"h_safe"})])),_:1})):x("",!0)])),_:1},512),i(O,{content:"本页内容仅供参考，具体以官方数据为准。"}),i(P,{mp_weixin:"adunit-8c89cc4610403c81",mp_qq:"54ea1b2e68ecb1caa66494c8dc68d3b7"}),i(A,{version:""})])),_:1})],64)}}},[["__scopeId","data-v-82e760de"]]);export{$ as default};
